<!doctype html><html lang=en-us dir=ltr><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-9H7R6FMDJ6"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9H7R6FMDJ6")</script><title>Build Script for Cloudflare and Hugo | Min Soe Han</title><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=sitemap type=application/xml title=Sitemap href=/sitemap.xml><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=manifest href=/favicon/site.webmanifest><link rel=stylesheet href=/fonts/material-symbols/outlined.css><link rel=stylesheet href=/fonts/material-symbols/rounded.css><link rel=stylesheet href=/fonts/fontawesome/css/fontawesome.css><link rel=stylesheet href=/fonts/fontawesome/css/brands.css><link rel=stylesheet href=/fonts/fontawesome/css/solid.css><link rel=stylesheet href=/css/base.min.88f5ea64224fbb3b323ac5805cdc6a93f855525062c87e2d22292682f4f6230f.css integrity="sha256-iPXqZCJPuzsyOsWAXNxqk/hVUlBiyH4tIikmgvT2Iw8=" crossorigin=anonymous><script src=/js/base.e9d32a2f00d55fb9f45a6c8e45c52ff66f454b256b93db5b2839b0bb8cc769d6.js integrity="sha256-6dMqLwDVX7n0WmyORcUv9m9FSyVrk9tbKDmwu4zHadY=" crossorigin=anonymous></script><link rel=stylesheet href=/css/header.min.01c32ec04fa9943f0cf44d37068767ca930b668def0b3272a96e811c22f97a5f.css integrity="sha256-AcMuwE+plD8M9E03BodnypMLZo3vCzJyqW6BHCL5el8=" crossorigin=anonymous><script src=/js/header.f6339e736e3ffe47d42cc3bd89737973190de92ed80e646a1e9ce2aa853a928e.js integrity="sha256-9jOec24//kfULMO9iXN5cxkN6S7YDmRqHpziqoU6ko4=" crossorigin=anonymous></script><link rel=stylesheet href=/css/footer.min.e407844c945fec8f835d68fd1a3b39c9faae95a69fa749ddf43c3daf7cd8fcfe.css integrity="sha256-5AeETJRf7I+DXWj9Gjs5yfqulaafp0nd9Dw9r3zY/P4=" crossorigin=anonymous><link rel=stylesheet href=/css/page.min.8c44fb29e7c18c137b030ac377090e74724f4df1aa0685526e7302198f7d8318.css integrity="sha256-jET7KefBjBN7AwrDdwkOdHJPTfGqBoVSbnMCGY99gxg=" crossorigin=anonymous><link rel=stylesheet href=/css/breadcrumbs.min.00e902ec96cc38f04e0a160ae899b9051183575541063a249295608ea09b6a82.css integrity="sha256-AOkC7JbMOPBOChYK6Jm5BRGDV1VBBjokkpVgjqCbaoI=" crossorigin=anonymous><link rel=stylesheet href=/css/aside.min.fa713eebf3ae798a6c6bd52e2616b053e58a56baafcb41f3fd3737c7d3b87cbf.css integrity="sha256-+nE+6/OueYpsa9UuJhawU+WKVrqvy0Hz/Tc3x9O4fL8=" crossorigin=anonymous><script src=/js/page.ff0da435803832c627173d1248f1dc93cd865707b71e80c19179eefc8452190b.js integrity="sha256-/w2kNYA4MsYnFz0SSPHck82GVwe3HoDBkXnu/IRSGQs=" crossorigin=anonymous></script></head><body><header><div class=row-one><div class=menu-title-search><span class=material-symbols-outlined id=mobile-menu-button>menu</span><div><a href=/ class=site-title>Min Soe Han</a></div><a href=/search class=main-search-icon><span class=material-symbols-outlined>search</span></a></div></div><div class=row-two><div class=navbar-wrapper><div class=left-box><nav><ul class=main-menu-parents><li><a aria-current=true class=ancestor href=/tech/>Tech</a></li><li><a href=/legal/>Legal<i class="fa-solid fa-chevron-down has-children-indicator"></i></a>
<span class="material-symbols-outlined toggle-child-menu">keyboard_arrow_right</span><ul class=main-menu-children><li><a href=/legal/labor-laws/>Labor Laws</a></li><li><a href=/legal/investment/>Investment</a></li></ul></li><li><a href=/open-diary/>Open Diary</a></li><li><a href=/others/>Others</a></li><li><a href=/about/>About</a></li></ul></nav></div><div class=right-box><a href=https://github.com/minsoehan><i class="fa-brands fa-github"></i></a>
<a href=https://codeberg.org/minsoehan><i class="fa-solid fa-code"></i></a><div><span class=material-symbols-outlined>email</span>&ensp;minsoehan243@gmail.com</div><div><span class=material-symbols-outlined>phone</span>&ensp;+95 9 25 731 3341</div></div></div></div><span class=material-symbols-outlined id=scrollup>keyboard_arrow_up</span></header><main><div class=breadcrumbs-wrapper><a href=/>home</a>
<span class=breadcrumbs-divider>></span>
<a href=/tech>tech</a>
<span class=breadcrumbs-divider>></span>
<span>build-script-for-cloudflare-and-hugo</span></div><div class=page><article data-pagefind-body><h1>Build Script for Cloudflare and Hugo</h1><span class=material-symbols-outlined id=expand-right-onoff>expand_circle_right</span>
<time datetime=2025-08-08T16:35:50+06:30>August 8, 2025</time><p>In Cloudflare Pages → Project Settings → Build Configuration, I can set the Framework preset to <code>Hugo</code>, the Build command to <code>hugo</code>, and the Build output directory to <code>public</code>. That’s the default when selecting Hugo.</p><p>However, when using Pagefind, even though I can set the Build command to <code>hugo && npx pagefind --site "public"</code>, it’s not quite satisfying. This is because, on every build, Cloudflare runs <code>hugo</code>, installs Pagefind, and then runs <code>npx pagefind --site "public"</code> again — which takes a long time.</p><p>Since I can already do this locally, I’m wondering why it should be so difficult. So instead, I select <code>None</code> for the Framework preset and leave both the Build command and the Build output directory blank. Then I run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hugo --destination<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/path/to/site-folder&#34;</span>
</span></span><span style=display:flex><span>npx pagefind --site <span style=color:#e6db74>&#34;site-folder&#34;</span>
</span></span></code></pre></div><p>After that, I push it to the GitHub repo. It’s a bit more cumbersome, but if I write a script, it’s manageable. The script is:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/dash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># check if root and exit</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#66d9ef>$(($(</span>id -u<span style=color:#66d9ef>)))</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#75715e># check if running in terminal or exit</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>ps -o stat<span style=color:#f92672>=</span> -p $$<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> in
</span></span><span style=display:flex><span>    *+*<span style=color:#f92672>)</span> echo <span style=color:#e6db74>&#34;continue...&#34;</span> ;;
</span></span><span style=display:flex><span>    *<span style=color:#f92672>)</span> notify-send -t <span style=color:#ae81ff>2700</span> <span style=color:#e6db74>&#34;clean exit&#34;</span> <span style=color:#e6db74>&#34;please run it in terminal&#34;</span>; exit <span style=color:#ae81ff>0</span> ;;
</span></span><span style=display:flex><span><span style=color:#66d9ef>esac</span>
</span></span><span style=display:flex><span><span style=color:#75715e># check already running or exit</span>
</span></span><span style=display:flex><span>SCRIPTNAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>basename -- <span style=color:#e6db74>&#34;</span>$0<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> pidof -x <span style=color:#e6db74>&#34;</span>$SCRIPTNAME<span style=color:#e6db74>&#34;</span> -o $$ &gt;/dev/null 2&gt;&amp;1; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;the script is already running. clean exit.&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># check input</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> echo <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> | grep <span style=color:#e6db74>&#34;/</span>$<span style=color:#e6db74>&#34;</span> &gt;/dev/null 2&gt;&amp;1; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Oops! your input is not clean. Please remove / ending.&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> echo <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> | grep <span style=color:#e6db74>&#34;/\*</span>$<span style=color:#e6db74>&#34;</span> &gt;/dev/null 2&gt;&amp;1; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Oops! your input is not clean. Please remove /* ending.&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> echo <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> | grep <span style=color:#e6db74>&#34;/\*\s&#34;</span> &gt;/dev/null 2&gt;&amp;1; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Oops! your input is not clean. Please remove /*  ending.&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> echo <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> | grep <span style=color:#e6db74>&#34;/\s&#34;</span> &gt;/dev/null 2&gt;&amp;1; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Oops! your input is not clean. Please remove /  ending.&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># START</span>
</span></span><span style=display:flex><span>FULLLINK<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>readlink -f <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! -d <span style=color:#e6db74>&#34;</span>$FULLLINK<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;::: Oops! &#34;</span>$FULLLINK<span style=color:#e6db74>&#34; is not directory or does not exist.&#34;</span>; exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SITE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>basename -- <span style=color:#e6db74>&#34;</span>$FULLLINK<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>PARENTDIR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>dirname -- <span style=color:#e6db74>&#34;</span>$FULLLINK<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;</span>$SITE<span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;</span>$PARENTDIR<span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;</span>$FULLLINK<span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>read -p <span style=color:#e6db74>&#34;Continue? [Y/n]: &#34;</span> CYN
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> $CYN in
</span></span><span style=display:flex><span>    n|no|N|No<span style=color:#f92672>)</span> echo <span style=color:#e6db74>&#34;::: exit...&#34;</span>; exit <span style=color:#ae81ff>0</span> ;;
</span></span><span style=display:flex><span>    *<span style=color:#f92672>)</span> echo <span style=color:#e6db74>&#34;::: continue...&#34;</span> ;;
</span></span><span style=display:flex><span><span style=color:#66d9ef>esac</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rm -rf <span style=color:#e6db74>&#34;</span>$FULLLINK<span style=color:#e6db74>&#34;</span>/*
</span></span><span style=display:flex><span>hugo --destination<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$FULLLINK<span style=color:#e6db74>&#34;</span> build
</span></span><span style=display:flex><span>cd <span style=color:#e6db74>&#34;</span>$PARENTDIR<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>npx pagefind --site <span style=color:#e6db74>&#34;</span>$SITE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>read -p <span style=color:#e6db74>&#34;Continue to git push? [Y/n]: &#34;</span> CGPYN
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> $CGPYN in
</span></span><span style=display:flex><span>    n|no|N|No<span style=color:#f92672>)</span> echo <span style=color:#e6db74>&#34;::: exit...&#34;</span>; exit <span style=color:#ae81ff>0</span> ;;
</span></span><span style=display:flex><span>    *<span style=color:#f92672>)</span> echo <span style=color:#e6db74>&#34;::: continue...&#34;</span> ;;
</span></span><span style=display:flex><span><span style=color:#66d9ef>esac</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd <span style=color:#e6db74>&#34;</span>$SITE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># continue to git push</span>
</span></span><span style=display:flex><span>git add .
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;updated&#34;</span>
</span></span><span style=display:flex><span>git push
</span></span></code></pre></div><section data-pagefind-ignore><div class=categories-tags-container><div class=categories><span>Categories&ensp;</span>
<span>&ensp;&bull;&#8202;</span>
<a href=/categories/tech/>Tech</a>
<span>&ensp;&bull;&#8202;</span>
<a href=/categories/script/>Script</a></div><div class=tags><span>Tags&ensp;</span>
<span>&ensp;&bull;&#8202;</span>
<a href=/tags/cloudflare/>Cloudflare</a>
<span>&ensp;&bull;&#8202;</span>
<a href=/tags/hugo/>Hugo</a>
<span>&ensp;&bull;&#8202;</span>
<a href=/tags/build/>Build</a>
<span>&ensp;&bull;&#8202;</span>
<a href=/tags/pagefind/>Pagefind</a></div></div></section></article><aside><div class=aside-sidebar><div class=section-info><h2><a href=/tech/>Tech Notes</a></h2><a href=/tech/controlling-running-a-script/>Controlling Running a Script</a>
<a href=/tech/myanmar-unicode-and-disqus-comment-box/>Myanmar Unicode and Disqus …</a>
<a href=/tech/build-script-for-cloudflare-and-hugo/>Build Script for Cloudflare …</a>
<a href=/tech/archlinux-notes/>Archlinux Notes</a>
<a href=/tech/calibri-cambria-fonts-linux/>Calibri Cambria Fonts Linux</a>
<a href=/tech/disable-drag-lock-dwl/>Disable Drag Lock DWL</a>
<a href=/tech/what-package-provides-what-command/>What Package Provides What …</a>
<a href=/tech/>MORE</a></div><div class=categories><h3><a href=/categories/>Categories</a></h3><a href=/categories/legal/>Legal (23)</a>
<a href=/categories/labor-law/>Labor Law (20)</a>
<a href=/categories/tech/>Tech (7)</a>
<a href=/categories/linux/>Linux (4)</a>
<a href=/categories/open-diary/>Open Diary (3)</a>
<a href=/categories/investment/>Investment (2)</a>
<a href=/categories>MORE</a></div><div class=tags><h3><a href=/tags/>Tags</a></h3><a href=/tags/leave-and-holiday/>Leave and Holiday (7)</a>
<a href=/tags/osh/>Osh (4)</a>
<a href=/tags/cloudflare/>Cloudflare (2)</a>
<a href=/tags/deduction/>Deduction (2)</a>
<a href=/tags/wages/>Wages (2)</a>
<a href=/tags/employment-contract/>Employment Contract (2)</a>
<a href=/tags/>MORE</a></div><div class=latest-posts><h3>Latest Posts</h3><a href=/legal/labor-laws/specially-relevant/>အထူးသက်ဆိုင်စေခြင်း</a>
<a href=/legal/labor-laws/occupational-welfare/>လုပ်ငန်းခွင် သက်သာချောင်ချိရေး</a>
<a href=/legal/labor-laws/occupational-safety/>လုပ်ငန်းခွင် ဘေးအန္တရာယ်ကင်းရှင်းရေး</a>
<a href=/legal/labor-laws/occupational-health/>လုပ်ငန်းခွင် ကျန်းမာရေး</a>
<a href=/legal/labor-laws/public-holiday/>အများပြည်သူ အလုပ်ပိတ်ရက်</a>
<a href=/legal/labor-laws/weekly-rest-day/>ရက်သတ္တပတ် အလုပ်ပိတ်ရက်</a>
<a href=/legal/labor-laws/ec-2017/>အလုပ်ခန့်ထားမှုဆိုင်ရာ သဘောတူညီချက်စာချုပ် - ၂၀၁၇</a>
<a href=/open-diary/no-framework-preset-in-cloudflare-pages/>No Framework Preset in Cloudflare Pages Project Settings</a>
<a href=/others/ygn-postal-codes/>Yangon Postal/Zip Codes</a></div></div></aside></div></main><footer><div class=wrapper><div class=left-box><a href=/>Min Soe Han</a></div><div class=right-box><p>&copy; All rights reserved by Min Soe Han</p></div></div></footer></body></html>